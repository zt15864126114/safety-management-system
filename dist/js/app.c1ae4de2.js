(function(t){function e(e){for(var s,l,o=e[0],n=e[1],c=e[2],u=0,p=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&p.push(i[l][0]),i[l]=0;for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);d&&d(e);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],s=!0,o=1;o<a.length;o++){var n=a[o];0!==i[n]&&(s=!1)}s&&(r.splice(e--,1),t=l(l.s=a[0]))}return t}var s={},i={app:0},r=[];function l(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=t,l.c=s,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)l.d(a,s,function(e){return t[e]}.bind(null,s));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],n=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=n;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},2749:function(t,e,a){},4360:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);var s=a("2b0e"),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("el-container",[e("el-header",[e("div",{staticClass:"header-content"},[e("div",{staticClass:"logo"},[e("i",{staticClass:"el-icon-monitor"}),e("span",[t._v("设备巡检管理系统")])]),e("div",{staticClass:"user-info"},[e("el-dropdown",{attrs:{trigger:"click"}},[e("span",{staticClass:"el-dropdown-link"},[t._v(" 管理员 "),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",[t._v("个人信息")]),e("el-dropdown-item",[t._v("修改密码")]),e("el-dropdown-item",{attrs:{divided:""}},[t._v("退出登录")])],1)],1)],1)])]),e("el-container",{staticClass:"main-container"},[e("el-aside",{attrs:{width:"200px"}},[e("el-menu",{staticClass:"el-menu-vertical",attrs:{"default-active":t.activeMenu,"background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409EFF"},on:{select:t.handleMenuSelect}},[e("el-menu-item",{attrs:{index:"inspection-task"}},[e("i",{staticClass:"el-icon-s-order"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("巡检任务")])]),e("el-menu-item",{attrs:{index:"alert-rules"}},[e("i",{staticClass:"el-icon-warning"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("预警规则")])]),e("el-menu-item",{attrs:{index:"statistics"}},[e("i",{staticClass:"el-icon-s-data"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("统计分析")])]),e("el-menu-item",{attrs:{index:"system-settings"}},[e("i",{staticClass:"el-icon-setting"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("系统设置")])])],1)],1),e("el-main",[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",[t._v("首页")]),e("el-breadcrumb-item",[t._v(t._s(t.currentMenuTitle))])],1),e("div",{staticClass:"main-content"},[e("keep-alive",[e(t.currentComponent,{tag:"component"})],1)],1)],1)],1)],1)],1)},r=[],l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"inspection-task"},[e("el-card",{staticClass:"search-card"},[e("el-form",{staticClass:"search-form",attrs:{inline:!0,model:t.searchForm}},[e("el-form-item",{attrs:{label:"任务名称"}},[e("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),e("el-form-item",{attrs:{label:"任务类型"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},[e("el-option",{attrs:{label:"全部",value:""}}),e("el-option",{attrs:{label:"日常巡检",value:"daily"}}),e("el-option",{attrs:{label:"专项巡检",value:"special"}}),e("el-option",{attrs:{label:"临时巡检",value:"temporary"}})],1)],1),e("el-form-item",{attrs:{label:"执行状态"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[e("el-option",{attrs:{label:"全部",value:""}}),e("el-option",{attrs:{label:"未开始",value:"pending"}}),e("el-option",{attrs:{label:"进行中",value:"processing"}}),e("el-option",{attrs:{label:"已暂停",value:"paused"}}),e("el-option",{attrs:{label:"已完成",value:"completed"}}),e("el-option",{attrs:{label:"已失败",value:"failed"}})],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查询")]),e("el-button",{on:{click:t.resetSearch}},[t._v("重置")]),e("el-button",{attrs:{type:"success"},on:{click:t.handleAdd}},[t._v("新增任务")])],1)],1)],1),e("el-card",{staticClass:"table-card"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tasksList}},[e("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"180"}}),e("el-table-column",{attrs:{prop:"type",label:"任务类型",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getTaskTypeName(e.row.type))+" ")]}}])}),e("el-table-column",{attrs:{prop:"executor",label:"执行人",width:"120"}}),e("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getStatusType(a.row.status)}},[t._v(" "+t._s(t.getStatusName(a.row.status))+" ")])]}}])}),e("el-table-column",{attrs:{prop:"planStartTime",label:"计划开始时间",width:"160"}}),e("el-table-column",{attrs:{prop:"planEndTime",label:"计划结束时间",width:"160"}}),e("el-table-column",{attrs:{prop:"progress",label:"进度",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-progress",{attrs:{percentage:a.row.progress,status:t.getProgressStatus(a.row)}})]}}])}),e("el-table-column",{attrs:{label:"操作",width:"250",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"processing"===a.row.status?"warning":"success",disabled:"completed"===a.row.status||"failed"===a.row.status},on:{click:function(e){return t.handleTaskControl(a.row)}}},[t._v(" "+t._s("processing"===a.row.status?"暂停":"开始")+" ")]),e("el-button",{attrs:{size:"mini",type:"primary",disabled:"completed"===a.row.status},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v(" 编辑 ")]),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.handleDelete(a.row)}}},[t._v(" 删除 ")])]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.pagination.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),e("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"50%","before-close":t.handleDialogClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"taskForm",attrs:{model:t.taskForm,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"任务名称",prop:"name"}},[e("el-input",{model:{value:t.taskForm.name,callback:function(e){t.$set(t.taskForm,"name",e)},expression:"taskForm.name"}})],1),e("el-form-item",{attrs:{label:"任务类型",prop:"type"}},[e("el-select",{attrs:{placeholder:"请选择任务类型"},model:{value:t.taskForm.type,callback:function(e){t.$set(t.taskForm,"type",e)},expression:"taskForm.type"}},[e("el-option",{attrs:{label:"日常巡检",value:"daily"}}),e("el-option",{attrs:{label:"专项巡检",value:"special"}}),e("el-option",{attrs:{label:"临时巡检",value:"temporary"}})],1)],1),e("el-form-item",{attrs:{label:"执行人",prop:"executor"}},[e("el-input",{model:{value:t.taskForm.executor,callback:function(e){t.$set(t.taskForm,"executor",e)},expression:"taskForm.executor"}})],1),e("el-form-item",{attrs:{label:"计划时间",required:""}},[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{prop:"planStartTime"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"开始时间"},model:{value:t.taskForm.planStartTime,callback:function(e){t.$set(t.taskForm,"planStartTime",e)},expression:"taskForm.planStartTime"}})],1)],1),e("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{prop:"planEndTime"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"结束时间"},model:{value:t.taskForm.planEndTime,callback:function(e){t.$set(t.taskForm,"planEndTime",e)},expression:"taskForm.planEndTime"}})],1)],1)],1),e("el-form-item",{attrs:{label:"巡检区域",prop:"areas"}},[e("el-select",{attrs:{multiple:"",placeholder:"请选择巡检区域"},model:{value:t.taskForm.areas,callback:function(e){t.$set(t.taskForm,"areas",e)},expression:"taskForm.areas"}},[e("el-option",{attrs:{label:"工厂1-车间A",value:"工厂1-车间A"}}),e("el-option",{attrs:{label:"工厂1-车间B",value:"工厂1-车间B"}}),e("el-option",{attrs:{label:"工厂2-车间A",value:"工厂2-车间A"}}),e("el-option",{attrs:{label:"工厂2-车间B",value:"工厂2-车间B"}})],1)],1),e("el-form-item",{attrs:{label:"备注",prop:"description"}},[e("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.taskForm.description,callback:function(e){t.$set(t.taskForm,"description",e)},expression:"taskForm.description"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleDialogClose}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("确 定")])],1)],1)],1)},o=[],n={name:"InspectionTask",data(){return{searchForm:{name:"",type:"",status:""},tasksList:[],loading:!1,pagination:{currentPage:1,pageSize:10,total:0},dialogVisible:!1,dialogTitle:"",taskForm:{id:null,name:"",type:"",executor:"",planStartTime:"",planEndTime:"",areas:[],description:""},rules:{name:[{required:!0,message:"请输入任务名称",trigger:"blur"}],type:[{required:!0,message:"请选择任务类型",trigger:"change"}],executor:[{required:!0,message:"请输入执行人",trigger:"blur"}],planStartTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],planEndTime:[{required:!0,message:"请选择结束时间",trigger:"change"}],areas:[{required:!0,message:"请选择巡检区域",trigger:"change"}]},mockDatabase:[{id:1,name:"设备日常巡检",type:"daily",executor:"张三",status:"processing",progress:60,planStartTime:"2024-01-20 09:00:00",planEndTime:"2024-01-20 17:00:00",areas:["工厂1-车间A"],description:"日常设备巡检任务"}]}},methods:{loadTasks(){this.loading=!0,setTimeout(()=>{let t=[...this.mockDatabase];this.searchForm.name&&(t=t.filter(t=>t.name.toLowerCase().includes(this.searchForm.name.toLowerCase()))),this.searchForm.type&&(t=t.filter(t=>t.type===this.searchForm.type)),this.searchForm.status&&(t=t.filter(t=>t.status===this.searchForm.status));const e=(this.pagination.currentPage-1)*this.pagination.pageSize,a=e+this.pagination.pageSize;this.pagination.total=t.length,this.tasksList=t.slice(e,a),this.loading=!1},500)},handleSearch(){this.pagination.currentPage=1,this.loadTasks()},resetSearch(){this.searchForm={name:"",type:"",status:""},this.handleSearch()},handleAdd(){this.dialogTitle="新增任务",this.taskForm={id:null,name:"",type:"",executor:"",planStartTime:"",planEndTime:"",areas:[],description:""},this.dialogVisible=!0},handleEdit(t){this.dialogTitle="编辑任务",this.taskForm={...t,planStartTime:t.planStartTime?new Date(t.planStartTime):"",planEndTime:t.planEndTime?new Date(t.planEndTime):""},this.dialogVisible=!0},handleDelete(t){this.$confirm("确认删除该任务?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.mockDatabase.findIndex(e=>e.id===t.id);-1!==e&&(this.mockDatabase.splice(e,1),this.$message.success("删除成功"),this.loadTasks())}).catch(()=>{})},handleSave(){this.$refs.taskForm.validate(t=>{if(t){if(this.taskForm.id){const t=this.mockDatabase.findIndex(t=>t.id===this.taskForm.id);-1!==t&&(this.mockDatabase[t]={...this.mockDatabase[t],...this.taskForm,planStartTime:this.formatDateTime(this.taskForm.planStartTime),planEndTime:this.formatDateTime(this.taskForm.planEndTime),updateTime:this.formatDateTime(new Date)})}else{const t={...this.taskForm,id:Date.now(),status:"pending",progress:0,planStartTime:this.formatDateTime(this.taskForm.planStartTime),planEndTime:this.formatDateTime(this.taskForm.planEndTime),createTime:this.formatDateTime(new Date),updateTime:this.formatDateTime(new Date)};this.mockDatabase.push(t)}this.$message.success("保存成功"),this.dialogVisible=!1,this.loadTasks()}})},handleTaskControl(t){const e="processing"!==t.status,a=e?"开始":"暂停";this.$confirm(`确认${a}该任务?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const s=this.mockDatabase.find(e=>e.id===t.id);s&&(s.status=e?"processing":"paused",e&&(s.progress=0),this.$message.success(a+"成功"),this.loadTasks())}).catch(()=>{})},formatDateTime(t){if(!t)return"";if("string"===typeof t)return t;const e=new Date(t),a=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return`${a}-${s}-${i} ${r}:${l}:${o}`},getTaskTypeName(t){const e={daily:"日常巡检",special:"专项巡检",temporary:"临时巡检"};return e[t]||t},getStatusType(t){const e={pending:"info",processing:"primary",paused:"warning",completed:"success",failed:"danger"};return e[t]||""},getStatusName(t){const e={pending:"未开始",processing:"进行中",paused:"已暂停",completed:"已完成",failed:"已失败"};return e[t]||t},getProgressStatus(t){return"completed"===t.status?"success":"paused"===t.status?"warning":"failed"===t.status?"exception":""},handleDialogClose(){this.$refs.taskForm.resetFields(),this.dialogVisible=!1},handleSizeChange(t){this.pagination.pageSize=t,this.loadTasks()},handleCurrentChange(t){this.pagination.currentPage=t,this.loadTasks()}},created(){this.loadTasks()}},c=n,d=(a("f70e"),a("2877")),u=Object(d["a"])(c,l,o,!1,null,"41a8001b",null),p=u.exports,m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"alert-rules"},[e("el-card",{staticClass:"search-card",attrs:{"body-style":{padding:"20px"}}},[e("el-form",{staticClass:"search-form",attrs:{inline:!0,model:t.searchForm}},[e("el-form-item",{attrs:{label:"规则名称"}},[e("el-input",{attrs:{placeholder:"请输入规则名称",clearable:""},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),e("el-form-item",{attrs:{label:"规则类型"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},[e("el-option",{attrs:{label:"阈值规则",value:"threshold"}}),e("el-option",{attrs:{label:"趋势规则",value:"trend"}}),e("el-option",{attrs:{label:"状态规则",value:"status"}})],1)],1),e("el-form-item",{attrs:{label:"预警等级"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.searchForm.level,callback:function(e){t.$set(t.searchForm,"level",e)},expression:"searchForm.level"}},[e("el-option",{attrs:{label:"高",value:"high"}}),e("el-option",{attrs:{label:"中",value:"medium"}}),e("el-option",{attrs:{label:"低",value:"low"}})],1)],1),e("el-form-item",{attrs:{label:"规则状态"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[e("el-option",{attrs:{label:"启用",value:!0}}),e("el-option",{attrs:{label:"停用",value:!1}})],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("查询")]),e("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.resetSearch}},[t._v("重置")]),e("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("新增规则")])],1)],1)],1),e("el-card",{staticClass:"table-card",attrs:{"body-style":{padding:"20px"}}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.rulesList,border:""}},[e("el-table-column",{attrs:{prop:"name",label:"规则名称","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{attrs:{content:a.row.description,placement:"top",effect:"light"}},[e("span",{staticClass:"rule-name"},[t._v(t._s(a.row.name))])])]}}])}),e("el-table-column",{attrs:{prop:"type",label:"规则类型",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getRuleTypeStyle(a.row.type)}},[t._v(" "+t._s(t.getRuleTypeName(a.row.type))+" ")])]}}])}),e("el-table-column",{attrs:{prop:"condition",label:"触发条件","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{attrs:{content:t.getConditionDetail(a.row),placement:"top",effect:"light"}},[e("span",[t._v(t._s(a.row.condition))])])]}}])}),e("el-table-column",{attrs:{prop:"level",label:"预警等级",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getAlertLevelType(a.row.level),effect:"dark"}},[t._v(" "+t._s(t.getAlertLevelName(a.row.level))+" ")])]}}])}),e("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e=>t.handleStatusChange(e,a.row)},model:{value:a.row.status,callback:function(e){t.$set(a.row,"status",e)},expression:"scope.row.status"}})]}}])}),e("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"160"}}),e("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v(" 编辑 ")]),e("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.handleDelete(a.row)}}},[t._v(" 删除 ")])]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.pagination.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),e("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"50%","before-close":t.handleDialogClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"规则名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"请输入规则名称"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),e("el-form-item",{attrs:{label:"规则类型",prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择规则类型"},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},[e("el-option",{attrs:{label:"阈值规则",value:"threshold"}}),e("el-option",{attrs:{label:"趋势规则",value:"trend"}}),e("el-option",{attrs:{label:"状态规则",value:"status"}})],1)],1),e("el-form-item",{attrs:{label:"触发条件",prop:"condition"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入触发条件"},model:{value:t.ruleForm.condition,callback:function(e){t.$set(t.ruleForm,"condition",e)},expression:"ruleForm.condition"}})],1),e("el-form-item",{attrs:{label:"预警等级",prop:"level"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择预警等级"},model:{value:t.ruleForm.level,callback:function(e){t.$set(t.ruleForm,"level",e)},expression:"ruleForm.level"}},[e("el-option",{attrs:{label:"高",value:"high"}}),e("el-option",{attrs:{label:"中",value:"medium"}}),e("el-option",{attrs:{label:"低",value:"low"}})],1)],1),e("el-form-item",{attrs:{label:"规则状态",prop:"status"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.ruleForm.status,callback:function(e){t.$set(t.ruleForm,"status",e)},expression:"ruleForm.status"}})],1),e("el-form-item",{attrs:{label:"规则描述",prop:"description"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入规则描述"},model:{value:t.ruleForm.description,callback:function(e){t.$set(t.ruleForm,"description",e)},expression:"ruleForm.description"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleDialogClose}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("确 定")])],1)],1)],1)},h=[],g={name:"AlertRules",data(){return{searchForm:{name:"",type:"",level:"",status:""},loading:!1,pagination:{currentPage:1,pageSize:10,total:0},rulesList:[],dialogVisible:!1,dialogTitle:"",ruleForm:{id:null,name:"",type:"",condition:"",level:"",status:!0,description:""},rules:{name:[{required:!0,message:"请输入规则名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择规则类型",trigger:"change"}],condition:[{required:!0,message:"请输入触发条件",trigger:"blur"}],level:[{required:!0,message:"请选择预警等级",trigger:"change"}],description:[{max:200,message:"长度不能超过 200 个字符",trigger:"blur"}]},mockDatabase:[{id:1,name:"温度过高预警",type:"threshold",condition:"温度 > 80°C",level:"high",status:!0,description:"设备温度过高预警规则",createTime:"2024-01-20 10:00:00"},{id:2,name:"压力异常预警",type:"trend",condition:"压力持续上升30分钟",level:"medium",status:!0,description:"设备压力异常预警规则",createTime:"2024-01-20 11:00:00"}]}},methods:{loadRules(){this.loading=!0,setTimeout(()=>{let t=[...this.mockDatabase];this.searchForm.name&&(t=t.filter(t=>t.name.toLowerCase().includes(this.searchForm.name.toLowerCase()))),this.searchForm.type&&(t=t.filter(t=>t.type===this.searchForm.type)),this.searchForm.level&&(t=t.filter(t=>t.level===this.searchForm.level)),""!==this.searchForm.status&&(t=t.filter(t=>t.status===this.searchForm.status));const e=(this.pagination.currentPage-1)*this.pagination.pageSize,a=e+this.pagination.pageSize;this.pagination.total=t.length,this.rulesList=t.slice(e,a),this.loading=!1},500)},handleSearch(){this.pagination.currentPage=1,this.loadRules()},resetSearch(){this.searchForm={name:"",type:"",level:"",status:""},this.handleSearch()},handleAdd(){this.dialogTitle="新增规则",this.ruleForm={id:null,name:"",type:"",condition:"",level:"",status:!0,description:""},this.dialogVisible=!0},handleEdit(t){this.dialogTitle="编辑规则",this.ruleForm={...t},this.dialogVisible=!0},handleDelete(t){this.$confirm("确认删除该规则?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.mockDatabase.findIndex(e=>e.id===t.id);-1!==e&&(this.mockDatabase.splice(e,1),this.$message.success("删除成功"),this.loadRules())}).catch(()=>{})},handleSave(){this.$refs.ruleForm.validate(t=>{if(t){if(this.ruleForm.id){const t=this.mockDatabase.findIndex(t=>t.id===this.ruleForm.id);-1!==t&&(this.mockDatabase[t]={...this.mockDatabase[t],...this.ruleForm,updateTime:this.formatDateTime(new Date)})}else{const t={...this.ruleForm,id:Date.now(),createTime:this.formatDateTime(new Date),updateTime:this.formatDateTime(new Date)};this.mockDatabase.push(t)}this.$message.success("保存成功"),this.dialogVisible=!1,this.loadRules()}})},handleStatusChange(t,e){const a=t?"启用":"停用";this.$message.success(a+"成功");const s=this.mockDatabase.findIndex(t=>t.id===e.id);-1!==s&&(this.mockDatabase[s].status=t)},handleDialogClose(){this.$refs.ruleForm.resetFields(),this.dialogVisible=!1},handleSizeChange(t){this.pagination.pageSize=t,this.loadRules()},handleCurrentChange(t){this.pagination.currentPage=t,this.loadRules()},getRuleTypeName(t){const e={threshold:"阈值规则",trend:"趋势规则",status:"状态规则"};return e[t]||t},getRuleTypeStyle(t){const e={threshold:"primary",trend:"success",status:"warning"};return e[t]||""},getAlertLevelName(t){const e={high:"高",medium:"中",low:"低"};return e[t]||t},getAlertLevelType(t){const e={high:"danger",medium:"warning",low:"info"};return e[t]||""},getConditionDetail(t){return`${t.name}\n${t.condition}\n${t.description}`},formatDateTime(t){if(!t)return"";const e=new Date(t),a=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return`${a}-${s}-${i} ${r}:${l}:${o}`}},created(){this.loadRules()}},v=g,b=(a("6940"),Object(d["a"])(v,m,h,!1,null,"a3cf5e04",null)),f=b.exports,y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"statistics"},[e("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"数据加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e("el-row",{staticClass:"data-overview",attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("el-card",{staticClass:"data-card",attrs:{shadow:"hover","body-style":{padding:"20px"}}},[e("div",{staticClass:"data-header"},[e("div",{staticClass:"data-title"},[t._v("总任务数")]),e("div",{staticClass:"icon-wrapper"},[e("i",{staticClass:"el-icon-s-order"}),e("div",{staticClass:"pulse-ring"})])]),e("div",{staticClass:"data-content"},[e("div",{staticClass:"data-number"},[e("count-to",{attrs:{"start-val":0,"end-val":t.statistics.totalTasks,duration:2500,autoplay:!0,separator:","}})],1),e("div",{staticClass:"data-trend"},[e("span",{class:{up:t.statistics.taskGrowth>0,down:t.statistics.taskGrowth<0}},[e("count-to",{attrs:{"start-val":0,"end-val":Math.abs(t.statistics.taskGrowth),duration:2e3,decimals:1,autoplay:!0}}),t._v("% "),e("i",{class:t.statistics.taskGrowth>0?"el-icon-top":"el-icon-bottom"})],1),t._v(" 较上月 ")])])])],1),e("el-col",{attrs:{span:6}},[e("el-card",{staticClass:"data-card",attrs:{shadow:"hover","body-style":{padding:"20px"}}},[e("div",{staticClass:"data-header"},[e("div",{staticClass:"data-title"},[t._v("完成率")]),e("div",{staticClass:"icon-wrapper success"},[e("i",{staticClass:"el-icon-s-data"}),e("div",{staticClass:"pulse-ring success"})])]),e("div",{staticClass:"data-content"},[e("div",{staticClass:"data-number"},[e("count-to",{attrs:{"start-val":0,"end-val":t.statistics.completionRate,duration:2500,autoplay:!0}}),t._v("% ")],1),e("div",{staticClass:"data-trend"},[e("span",{class:{up:t.statistics.completionGrowth>0,down:t.statistics.completionGrowth<0}},[e("count-to",{attrs:{"start-val":0,"end-val":Math.abs(t.statistics.completionGrowth),duration:2e3,decimals:1,autoplay:!0}}),t._v("% "),e("i",{class:t.statistics.completionGrowth>0?"el-icon-top":"el-icon-bottom"})],1),t._v(" 较上月 ")])])])],1),e("el-col",{attrs:{span:6}},[e("el-card",{staticClass:"data-card",attrs:{shadow:"hover","body-style":{padding:"20px"}}},[e("div",{staticClass:"data-header"},[e("div",{staticClass:"data-title"},[t._v("异常发现")]),e("div",{staticClass:"icon-wrapper warning"},[e("i",{staticClass:"el-icon-warning"}),e("div",{staticClass:"pulse-ring warning"})])]),e("div",{staticClass:"data-content"},[e("div",{staticClass:"data-number"},[e("count-to",{attrs:{"start-val":0,"end-val":t.statistics.totalIssues,duration:2500,autoplay:!0}})],1),e("div",{staticClass:"data-trend"},[e("span",{class:{down:t.statistics.issueGrowth>0,up:t.statistics.issueGrowth<0}},[e("count-to",{attrs:{"start-val":0,"end-val":Math.abs(t.statistics.issueGrowth),duration:2e3,decimals:1,autoplay:!0}}),t._v("% "),e("i",{class:t.statistics.issueGrowth>0?"el-icon-top":"el-icon-bottom"})],1),t._v(" 较上月 ")])])])],1),e("el-col",{attrs:{span:6}},[e("el-card",{staticClass:"data-card",attrs:{shadow:"hover","body-style":{padding:"20px"}}},[e("div",{staticClass:"data-header"},[e("div",{staticClass:"data-title"},[t._v("处理及时率")]),e("div",{staticClass:"icon-wrapper info"},[e("i",{staticClass:"el-icon-time"}),e("div",{staticClass:"pulse-ring info"})])]),e("div",{staticClass:"data-content"},[e("div",{staticClass:"data-number"},[e("count-to",{attrs:{"start-val":0,"end-val":t.statistics.responseRate,duration:2500,autoplay:!0}}),t._v("% ")],1),e("div",{staticClass:"data-trend"},[e("span",{class:{up:t.statistics.responseGrowth>0,down:t.statistics.responseGrowth<0}},[e("count-to",{attrs:{"start-val":0,"end-val":Math.abs(t.statistics.responseGrowth),duration:2e3,decimals:1,autoplay:!0}}),t._v("% "),e("i",{class:t.statistics.responseGrowth>0?"el-icon-top":"el-icon-bottom"})],1),t._v(" 较上月 ")])])])],1)],1),e("el-row",{staticClass:"chart-row",attrs:{gutter:20}},[e("el-col",{attrs:{span:16}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("任务趋势分析")]),e("el-radio-group",{attrs:{size:"small"},model:{value:t.trendTimeRange,callback:function(e){t.trendTimeRange=e},expression:"trendTimeRange"}},[e("el-radio-button",{attrs:{label:"week"}},[t._v("周")]),e("el-radio-button",{attrs:{label:"month"}},[t._v("月")]),e("el-radio-button",{attrs:{label:"year"}},[t._v("年")])],1)],1),e("div",{ref:"trendChart",staticClass:"chart-container"})])],1),e("el-col",{attrs:{span:8}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("任务类型分布")])]),e("div",{ref:"typeChart",staticClass:"chart-container"})])],1)],1),e("el-row",{staticClass:"chart-row",attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("区域任务热力图")])]),e("div",{ref:"areaChart",staticClass:"chart-container"})])],1),e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("异常类型分析")])]),e("div",{ref:"issueChart",staticClass:"chart-container"})])],1)],1)],1)])},w=[],k=a("313e"),C=a("ec1b"),T=a.n(C),F={name:"Statistics",components:{CountTo:T.a},data(){return{loading:!0,trendTimeRange:"month",timer:null,statistics:{totalTasks:256,taskGrowth:12.5,completionRate:92,completionGrowth:3.2,totalIssues:15,issueGrowth:-8.5,responseRate:95,responseGrowth:2.1},charts:{trend:null,type:null,area:null,issue:null}}},watch:{trendTimeRange(){this.initTrendChart()}},methods:{initCharts(){this.initTrendChart(),this.initTypeChart(),this.initAreaChart(),this.initIssueChart()},initTrendChart(){this.charts.trend||(this.charts.trend=k["init"](this.$refs.trendChart));const t={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["总任务数","已完成","异常数"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:this.getTrendTimeData(),axisLine:{lineStyle:{color:"#666"}}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#666"}}},series:[{name:"总任务数",type:"line",smooth:!0,data:this.getRandomData(12,40,90),animationDuration:2e3,animationEasing:"cubicInOut",itemStyle:{color:"#409EFF"}},{name:"已完成",type:"line",smooth:!0,data:this.getRandomData(12,30,80),animationDuration:2e3,animationEasing:"cubicInOut",itemStyle:{color:"#67C23A"}},{name:"异常数",type:"line",smooth:!0,data:this.getRandomData(12,0,20),animationDuration:2e3,animationEasing:"cubicInOut",itemStyle:{color:"#F56C6C"}}]};this.charts.trend.setOption(t)},initTypeChart(){this.charts.type||(this.charts.type=k["init"](this.$refs.typeChart));const t={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center",data:["日常巡检","专项巡检","临时巡检"]},series:[{name:"任务类型",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"20",fontWeight:"bold"},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},labelLine:{show:!1},data:[{value:50,name:"日常巡检"},{value:30,name:"专项巡检"},{value:20,name:"临时巡检"}],animationDuration:2e3,animationEasing:"cubicInOut"}]};this.charts.type.setOption(t)},initAreaChart(){this.charts.area||(this.charts.area=k["init"](this.$refs.areaChart));const t={tooltip:{position:"top"},grid:{top:"10%",containLabel:!0},xAxis:{type:"category",data:["车间A","车间B","车间C","车间D"],splitArea:{show:!0}},yAxis:{type:"category",data:["工厂1","工厂2","工厂3"],splitArea:{show:!0}},visualMap:{min:0,max:100,calculable:!0,orient:"horizontal",left:"center",bottom:"0%",inRange:{color:["#e9f7fe","#409EFF"]}},series:[{name:"任务数量",type:"heatmap",data:this.getHeatmapData(),label:{show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationDuration:2e3,animationEasing:"cubicInOut"}]};this.charts.area.setOption(t)},initIssueChart(){this.charts.issue||(this.charts.issue=k["init"](this.$refs.issueChart));const t={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:["设备故障","参数异常","安全隐患","环境问题","其他"]},series:[{name:"异常数量",type:"bar",data:[5,4,3,2,1],itemStyle:{color:function(t){const e=["#F56C6C","#E6A23C","#409EFF","#67C23A","#909399"];return e[t.dataIndex]}},label:{show:!0,position:"right"},animationDuration:2e3,animationEasing:"cubicInOut"}]};this.charts.issue.setOption(t)},startRealTimeUpdate(){this.timer=setInterval(()=>{if(this.statistics.totalTasks+=Math.floor(5*Math.random()),this.charts.trend){const t=this.charts.trend.getOption(),e=t.series[0].data;e.shift(),e.push(this.getRandomData(1,40,90)[0]),this.charts.trend.setOption({series:[{data:e}]})}},5e3)},getTrendTimeData(){const t=new Date,e=[];if("week"===this.trendTimeRange){const a=["周日","周一","周二","周三","周四","周五","周六"];for(let s=6;s>=0;s--)e.push(a[new Date(t-24*s*3600*1e3).getDay()])}else if("month"===this.trendTimeRange)for(let a=11;a>=0;a--){const s=new Date(t.getFullYear(),t.getMonth()-a,1);e.push(s.getMonth()+1+"月")}else for(let a=11;a>=0;a--)e.push(t.getFullYear()-a+"年");return e},getRandomData(t,e,a){return Array.from({length:t},()=>Math.floor(Math.random()*(a-e+1))+e)},getHeatmapData(){const t=[];for(let e=0;e<3;e++)for(let a=0;a<4;a++)t.push([a,e,Math.floor(100*Math.random())]);return t},handleResize(){Object.values(this.charts).forEach(t=>{t&&t.resize()})}},mounted(){setTimeout(()=>{this.loading=!1,this.initCharts(),this.startRealTimeUpdate(),window.addEventListener("resize",this.handleResize)},1500)},beforeDestroy(){this.timer&&clearInterval(this.timer),window.removeEventListener("resize",this.handleResize),Object.values(this.charts).forEach(t=>{t&&t.dispose()})}},S=F,x=(a("ac5f"),Object(d["a"])(S,y,w,!1,null,"303da50a",null)),_=x.exports,D={name:"App",components:{InspectionTask:p,AlertRules:f,Statistics:_},data(){return{activeMenu:"inspection-task",menuTitles:{"inspection-task":"巡检任务","alert-rules":"预警规则",statistics:"统计分析","system-settings":"系统设置"}}},computed:{currentMenuTitle(){return this.menuTitles[this.activeMenu]},currentComponent(){const t={"inspection-task":"InspectionTask","alert-rules":"AlertRules",statistics:"Statistics","system-settings":"SystemSettings"};return t[this.activeMenu]}},methods:{handleMenuSelect(t){this.activeMenu=t}}},$=D,R=(a("a43d"),Object(d["a"])($,i,r,!1,null,null,null)),z=R.exports,E=a("a18c"),A=a.n(E),O=a("4360"),M=a.n(O),L=a("5c96"),I=a.n(L);a("0fae");s["default"].use(I.a),s["default"].config.productionTip=!1,new s["default"]({router:A.a,store:M.a,render:t=>t(z)}).$mount("#app")},6940:function(t,e,a){"use strict";a("2749")},"71e7":function(t,e,a){},a18c:function(t,e){},a43d:function(t,e,a){"use strict";a("bbdd")},ac5f:function(t,e,a){"use strict";a("b352")},b352:function(t,e,a){},bbdd:function(t,e,a){},f70e:function(t,e,a){"use strict";a("71e7")}});
//# sourceMappingURL=app.c1ae4de2.js.map