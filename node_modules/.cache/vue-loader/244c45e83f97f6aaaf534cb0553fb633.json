{"remainingRequest":"D:\\safety-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\safety-management-system\\src\\views\\Analysis.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\safety-management-system\\src\\views\\Analysis.vue","mtime":1735550417502},{"path":"D:\\safety-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\safety-management-system\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\safety-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\safety-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgKiBhcyBlY2hhcnRzIGZyb20gJ2VjaGFydHMnDQppbXBvcnQgeyBzYXZlQXMgfSBmcm9tICdmaWxlLXNhdmVyJw0KaW1wb3J0ICogYXMgWExTWCBmcm9tICd4bHN4Jw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdBbmFseXNpcycsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIC8vIOWIhuaekOihqOWNlQ0KICAgICAgYW5hbHlzaXNGb3JtOiB7DQogICAgICAgIHR5cGU6ICcnLA0KICAgICAgICBtZXRyaWNzOiBbXSwNCiAgICAgICAgZGF0ZVJhbmdlOiBbXSwNCiAgICAgICAgZ3JhbnVsYXJpdHk6ICcnLA0KICAgICAgICBkZXZpY2VzOiBbXQ0KICAgICAgfSwNCiAgICAgIC8vIOihqOWNlemqjOivgeinhOWImQ0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgdHlwZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nliIbmnpDnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XSwNCiAgICAgICAgbWV0cmljczogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nmlbDmja7mjIfmoIcnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XSwNCiAgICAgICAgZGF0ZVJhbmdlOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeaXtumXtOiMg+WbtCcsIHRyaWdnZXI6ICdjaGFuZ2UnIH1dLA0KICAgICAgICBncmFudWxhcml0eTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nmlbDmja7nspLluqYnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XSwNCiAgICAgICAgZGV2aWNlczogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6norr7lpIcnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9XQ0KICAgICAgfSwNCiAgICAgIC8vIOiuvuWkh+WIl+ihqA0KICAgICAgZGV2aWNlTGlzdDogW10sDQogICAgICAvLyDliqDovb3nirbmgIENCiAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgLy8g5YiG5p6Q57uT6K66DQogICAgICBjb25jbHVzaW9uOiBudWxsLA0KICAgICAgLy8g6KGo5qC85pWw5o2uDQogICAgICB0YWJsZURhdGE6IFtdLA0KICAgICAgdGFibGVDb2x1bW5zOiBbXSwNCiAgICAgIGN1cnJlbnRQYWdlOiAxLA0KICAgICAgcGFnZVNpemU6IDEwLA0KICAgICAgdG90YWw6IDAsDQogICAgICAvLyDmqKHmnb/lr7nor53moYYNCiAgICAgIHRlbXBsYXRlRGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICB0ZW1wbGF0ZUZvcm06IHsNCiAgICAgICAgbmFtZTogJycsDQogICAgICAgIGRlc2NyaXB0aW9uOiAnJw0KICAgICAgfSwNCiAgICAgIHRlbXBsYXRlUnVsZXM6IHsNCiAgICAgICAgbmFtZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXmqKHmnb/lkI3np7AnLCB0cmlnZ2VyOiAnYmx1cicgfV0NCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5nZXREZXZpY2VMaXN0KCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8vIOiOt+WPluiuvuWkh+WIl+ihqA0KICAgIGFzeW5jIGdldERldmljZUxpc3QoKSB7DQogICAgICAvLyDmqKHmi59BUEnosIPnlKgNCiAgICAgIHRoaXMuZGV2aWNlTGlzdCA9IFsNCiAgICAgICAgeyBpZDogJ0RFVjAwMScsIG5hbWU6ICflj43lupTph5xBJyB9LA0KICAgICAgICB7IGlkOiAnREVWMDAyJywgbmFtZTogJ+WCqOe9kEInIH0NCiAgICAgIF0NCiAgICB9LA0KDQogICAgLy8g5byA5aeL5YiG5p6QDQogICAgc3RhcnRBbmFseXNpcygpIHsNCiAgICAgIHRoaXMuJHJlZnMuYW5hbHlzaXNGb3JtLnZhbGlkYXRlKHZhbGlkID0+IHsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQ0KICAgICAgICAgIC8vIOaooeaLn+WIhuaekOi/h+eoiw0KICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZUFuYWx5c2lzUmVzdWx0KCkNCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlDQogICAgICAgICAgfSwgMjAwMCkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KDQogICAgLy8g55Sf5oiQ5YiG5p6Q57uT5p6cDQogICAgZ2VuZXJhdGVBbmFseXNpc1Jlc3VsdCgpIHsNCiAgICAgIC8vIOeUn+aIkOWbvuihqA0KICAgICAgdGhpcy5pbml0Q2hhcnQoKQ0KDQogICAgICAvLyDnlJ/miJDnu5PorroNCiAgICAgIHRoaXMuY29uY2x1c2lvbiA9IHsNCiAgICAgICAgdGl0bGU6ICfliIbmnpDlj5HnjrDlvILluLjotovlir8nLA0KICAgICAgICB0eXBlOiAnd2FybmluZycsDQogICAgICAgIGRlc2NyaXB0aW9uOiAn5Zyo6L+H5Y67MjTlsI/ml7blhoXvvIzorr7lpIfmuKnluqblkYjnjrDkuIrljYfotovlir/vvIzlu7rorq7lhbPms6jjgIInDQogICAgICB9DQoNCiAgICAgIC8vIOeUn+aIkOihqOagvOaVsOaNrg0KICAgICAgdGhpcy5nZW5lcmF0ZVRhYmxlRGF0YSgpDQogICAgfSwNCg0KICAgIC8vIOWIneWni+WMluWbvuihqA0KICAgIGluaXRDaGFydCgpIHsNCiAgICAgIGNvbnN0IGNoYXJ0ID0gZWNoYXJ0cy5pbml0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ2hhcnQnKSkNCiAgICAgIGNvbnN0IG9wdGlvbiA9IHsNCiAgICAgICAgLy8g5Zu+6KGo6YWN572uLi4uDQogICAgICB9DQogICAgICBjaGFydC5zZXRPcHRpb24ob3B0aW9uKQ0KICAgIH0sDQoNCiAgICAvLyDnlJ/miJDooajmoLzmlbDmja4NCiAgICBnZW5lcmF0ZVRhYmxlRGF0YSgpIHsNCiAgICAgIC8vIOeUn+aIkOihqOagvOWIlw0KICAgICAgdGhpcy50YWJsZUNvbHVtbnMgPSBbDQogICAgICAgIHsgcHJvcDogJ3RpbWUnLCBsYWJlbDogJ+aXtumXtCcsIHdpZHRoOiAnMTgwJyB9LA0KICAgICAgICB7IHByb3A6ICdkZXZpY2UnLCBsYWJlbDogJ+iuvuWkhycsIHdpZHRoOiAnMTIwJyB9LA0KICAgICAgICB7IHByb3A6ICd2YWx1ZScsIGxhYmVsOiAn5pWw5YC8Jywgd2lkdGg6ICcxMDAnIH0NCiAgICAgIF0NCg0KICAgICAgLy8g55Sf5oiQ6KGo5qC85pWw5o2uDQogICAgICB0aGlzLnRhYmxlRGF0YSA9IFsNCiAgICAgICAgeyB0aW1lOiAnMjAyNC0wMS0yMCAxMDowMCcsIGRldmljZTogJ+WPjeW6lOmHnEEnLCB2YWx1ZTogNjUuMiB9LA0KICAgICAgICB7IHRpbWU6ICcyMDI0LTAxLTIwIDEwOjMwJywgZGV2aWNlOiAn5Y+N5bqU6YecQScsIHZhbHVlOiA2Ni41IH0NCiAgICAgIF0NCiAgICAgIHRoaXMudG90YWwgPSB0aGlzLnRhYmxlRGF0YS5sZW5ndGgNCiAgICB9LA0KDQogICAgLy8g5a+85Ye65pWw5o2uDQogICAgZXhwb3J0RGF0YSgpIHsNCiAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpDQogICAgICBjb25zdCB3cyA9IFhMU1gudXRpbHMuanNvbl90b19zaGVldCh0aGlzLnRhYmxlRGF0YSkNCiAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzLCAn5YiG5p6Q5pWw5o2uJykNCiAgICAgIGNvbnN0IHdib3V0ID0gWExTWC53cml0ZSh3YiwgeyBib29rVHlwZTogJ3hsc3gnLCB0eXBlOiAnYXJyYXknIH0pDQogICAgICBzYXZlQXMobmV3IEJsb2IoW3dib3V0XSwgeyB0eXBlOiAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJyB9KSwgJ+WIhuaekOaVsOaNri54bHN4JykNCiAgICB9LA0KDQogICAgLy8g5a+85Ye65Zu+6KGoDQogICAgZXhwb3J0SW1hZ2UoKSB7DQogICAgICBjb25zdCBjaGFydCA9IGVjaGFydHMuZ2V0SW5zdGFuY2VCeURvbShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNoYXJ0JykpDQogICAgICBjb25zdCB1cmwgPSBjaGFydC5nZXREYXRhVVJMKCkNCiAgICAgIHNhdmVBcyh0aGlzLmRhdGFVUkx0b0Jsb2IodXJsKSwgJ+WIhuaekOWbvuihqC5wbmcnKQ0KICAgIH0sDQoNCiAgICAvLyBEYXRhVVJM6L2sQmxvYg0KICAgIGRhdGFVUkx0b0Jsb2IoZGF0YXVybCkgew0KICAgICAgY29uc3QgYXJyID0gZGF0YXVybC5zcGxpdCgnLCcpDQogICAgICBjb25zdCBtaW1lID0gYXJyWzBdLm1hdGNoKC86KC4qPyk7LylbMV0NCiAgICAgIGNvbnN0IGJzdHIgPSBhdG9iKGFyclsxXSkNCiAgICAgIGxldCBuID0gYnN0ci5sZW5ndGgNCiAgICAgIGNvbnN0IHU4YXJyID0gbmV3IFVpbnQ4QXJyYXkobikNCiAgICAgIHdoaWxlIChuLS0pIHsNCiAgICAgICAgdThhcnJbbl0gPSBic3RyLmNoYXJDb2RlQXQobikNCiAgICAgIH0NCiAgICAgIHJldHVybiBuZXcgQmxvYihbdThhcnJdLCB7IHR5cGU6IG1pbWUgfSkNCiAgICB9LA0KDQogICAgLy8g5L+d5a2Y5Li65qih5p2/DQogICAgc2F2ZUFzVGVtcGxhdGUoKSB7DQogICAgICB0aGlzLnRlbXBsYXRlRGlhbG9nVmlzaWJsZSA9IHRydWUNCiAgICB9LA0KDQogICAgLy8g5L+d5a2Y5qih5p2/DQogICAgc2F2ZVRlbXBsYXRlKCkgew0KICAgICAgdGhpcy4kcmVmcy50ZW1wbGF0ZUZvcm0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICAvLyDkv53lrZjmqKHmnb/pgLvovpENCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+aooeadv+S/neWtmOaIkOWKnycpDQogICAgICAgICAgdGhpcy50ZW1wbGF0ZURpYWxvZ1Zpc2libGUgPSBmYWxzZQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQoNCiAgICAvLyDph43nva7ooajljZUNCiAgICByZXNldEZvcm0oKSB7DQogICAgICB0aGlzLiRyZWZzLmFuYWx5c2lzRm9ybS5yZXNldEZpZWxkcygpDQogICAgfSwNCg0KICAgIC8vIOWIhumhteWkhOeQhg0KICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7DQogICAgICB0aGlzLnBhZ2VTaXplID0gdmFsDQogICAgfSwNCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgew0KICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IHZhbA0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["Analysis.vue"],"names":[],"mappings":";AA+JA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Analysis.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"analysis\">\r\n    <!-- 分析条件设置 -->\r\n    <el-card>\r\n      <div slot=\"header\">\r\n        <span>数据分析条件</span>\r\n        <el-button style=\"float: right\"\r\n                   type=\"primary\"\r\n                   size=\"small\"\r\n                   @click=\"saveAsTemplate\">\r\n          保存为模板\r\n        </el-button>\r\n      </div>\r\n\r\n      <el-form :model=\"analysisForm\" :rules=\"rules\" ref=\"analysisForm\" label-width=\"100px\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"分析类型\" prop=\"type\">\r\n              <el-select v-model=\"analysisForm.type\" placeholder=\"请选择分析类型\">\r\n                <el-option label=\"趋势分析\" value=\"trend\"></el-option>\r\n                <el-option label=\"对比分析\" value=\"compare\"></el-option>\r\n                <el-option label=\"相关性分析\" value=\"correlation\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"数据指标\" prop=\"metrics\">\r\n              <el-select v-model=\"analysisForm.metrics\"\r\n                         multiple\r\n                         placeholder=\"请选择数据指标\">\r\n                <el-option label=\"温度\" value=\"temperature\"></el-option>\r\n                <el-option label=\"压力\" value=\"pressure\"></el-option>\r\n                <el-option label=\"流量\" value=\"flow\"></el-option>\r\n                <el-option label=\"设备状态\" value=\"status\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"时间范围\" prop=\"dateRange\">\r\n              <el-date-picker\r\n                  v-model=\"analysisForm.dateRange\"\r\n                  type=\"daterange\"\r\n                  range-separator=\"至\"\r\n                  start-placeholder=\"开始日期\"\r\n                  end-placeholder=\"结束日期\">\r\n              </el-date-picker>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"数据粒度\" prop=\"granularity\">\r\n              <el-select v-model=\"analysisForm.granularity\" placeholder=\"请选择数据粒度\">\r\n                <el-option label=\"分钟\" value=\"minute\"></el-option>\r\n                <el-option label=\"小时\" value=\"hour\"></el-option>\r\n                <el-option label=\"天\" value=\"day\"></el-option>\r\n                <el-option label=\"月\" value=\"month\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"设备选择\" prop=\"devices\">\r\n              <el-select v-model=\"analysisForm.devices\"\r\n                         multiple\r\n                         placeholder=\"请选择设备\">\r\n                <el-option\r\n                    v-for=\"device in deviceList\"\r\n                    :key=\"device.id\"\r\n                    :label=\"device.name\"\r\n                    :value=\"device.id\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"startAnalysis\">开始分析</el-button>\r\n              <el-button @click=\"resetForm\">重置</el-button>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n    </el-card>\r\n\r\n    <!-- 分析结果展示 -->\r\n    <el-card style=\"margin-top: 20px;\" v-loading=\"loading\">\r\n      <div slot=\"header\">\r\n        <span>分析结果</span>\r\n        <el-button-group style=\"float: right\">\r\n          <el-button size=\"small\" @click=\"exportData\">导出数据</el-button>\r\n          <el-button size=\"small\" @click=\"exportImage\">导出图表</el-button>\r\n        </el-button-group>\r\n      </div>\r\n\r\n      <!-- 图表展示区域 -->\r\n      <div class=\"chart-container\">\r\n        <div id=\"mainChart\" style=\"height: 400px;\"></div>\r\n      </div>\r\n\r\n      <!-- 分析结论 -->\r\n      <div class=\"analysis-conclusion\" v-if=\"conclusion\">\r\n        <h3>分析结论</h3>\r\n        <el-alert\r\n            :title=\"conclusion.title\"\r\n            :type=\"conclusion.type\"\r\n            :description=\"conclusion.description\"\r\n            show-icon>\r\n        </el-alert>\r\n      </div>\r\n\r\n      <!-- 详细数据表格 -->\r\n      <div class=\"data-table\" v-if=\"tableData.length\">\r\n        <h3>详细数据</h3>\r\n        <el-table :data=\"tableData\" border style=\"width: 100%\">\r\n          <el-table-column\r\n              v-for=\"(col, index) in tableColumns\"\r\n              :key=\"index\"\r\n              :prop=\"col.prop\"\r\n              :label=\"col.label\"\r\n              :width=\"col.width\">\r\n          </el-table-column>\r\n        </el-table>\r\n        <div class=\"pagination-container\">\r\n          <el-pagination\r\n              @size-change=\"handleSizeChange\"\r\n              @current-change=\"handleCurrentChange\"\r\n              :current-page=\"currentPage\"\r\n              :page-sizes=\"[10, 20, 50, 100]\"\r\n              :page-size=\"pageSize\"\r\n              layout=\"total, sizes, prev, pager, next, jumper\"\r\n              :total=\"total\">\r\n          </el-pagination>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 保存模板对话框 -->\r\n    <el-dialog title=\"保存分析模板\" :visible.sync=\"templateDialogVisible\">\r\n      <el-form :model=\"templateForm\" :rules=\"templateRules\" ref=\"templateForm\">\r\n        <el-form-item label=\"模板名称\" prop=\"name\">\r\n          <el-input v-model=\"templateForm.name\" placeholder=\"请输入模板名称\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"模板描述\" prop=\"description\">\r\n          <el-input type=\"textarea\"\r\n                    v-model=\"templateForm.description\"\r\n                    placeholder=\"请输入模板描述\">\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\">\r\n        <el-button @click=\"templateDialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveTemplate\">保存</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from 'echarts'\r\nimport { saveAs } from 'file-saver'\r\nimport * as XLSX from 'xlsx'\r\n\r\nexport default {\r\n  name: 'Analysis',\r\n  data() {\r\n    return {\r\n      // 分析表单\r\n      analysisForm: {\r\n        type: '',\r\n        metrics: [],\r\n        dateRange: [],\r\n        granularity: '',\r\n        devices: []\r\n      },\r\n      // 表单验证规则\r\n      rules: {\r\n        type: [{ required: true, message: '请选择分析类型', trigger: 'change' }],\r\n        metrics: [{ required: true, message: '请选择数据指标', trigger: 'change' }],\r\n        dateRange: [{ required: true, message: '请选择时间范围', trigger: 'change' }],\r\n        granularity: [{ required: true, message: '请选择数据粒度', trigger: 'change' }],\r\n        devices: [{ required: true, message: '请选择设备', trigger: 'change' }]\r\n      },\r\n      // 设备列表\r\n      deviceList: [],\r\n      // 加载状态\r\n      loading: false,\r\n      // 分析结论\r\n      conclusion: null,\r\n      // 表格数据\r\n      tableData: [],\r\n      tableColumns: [],\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      total: 0,\r\n      // 模板对话框\r\n      templateDialogVisible: false,\r\n      templateForm: {\r\n        name: '',\r\n        description: ''\r\n      },\r\n      templateRules: {\r\n        name: [{ required: true, message: '请输入模板名称', trigger: 'blur' }]\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getDeviceList()\r\n  },\r\n  methods: {\r\n    // 获取设备列表\r\n    async getDeviceList() {\r\n      // 模拟API调用\r\n      this.deviceList = [\r\n        { id: 'DEV001', name: '反应釜A' },\r\n        { id: 'DEV002', name: '储罐B' }\r\n      ]\r\n    },\r\n\r\n    // 开始分析\r\n    startAnalysis() {\r\n      this.$refs.analysisForm.validate(valid => {\r\n        if (valid) {\r\n          this.loading = true\r\n          // 模拟分析过程\r\n          setTimeout(() => {\r\n            this.generateAnalysisResult()\r\n            this.loading = false\r\n          }, 2000)\r\n        }\r\n      })\r\n    },\r\n\r\n    // 生成分析结果\r\n    generateAnalysisResult() {\r\n      // 生成图表\r\n      this.initChart()\r\n\r\n      // 生成结论\r\n      this.conclusion = {\r\n        title: '分析发现异常趋势',\r\n        type: 'warning',\r\n        description: '在过去24小时内，设备温度呈现上升趋势，建议关注。'\r\n      }\r\n\r\n      // 生成表格数据\r\n      this.generateTableData()\r\n    },\r\n\r\n    // 初始化图表\r\n    initChart() {\r\n      const chart = echarts.init(document.getElementById('mainChart'))\r\n      const option = {\r\n        // 图表配置...\r\n      }\r\n      chart.setOption(option)\r\n    },\r\n\r\n    // 生成表格数据\r\n    generateTableData() {\r\n      // 生成表格列\r\n      this.tableColumns = [\r\n        { prop: 'time', label: '时间', width: '180' },\r\n        { prop: 'device', label: '设备', width: '120' },\r\n        { prop: 'value', label: '数值', width: '100' }\r\n      ]\r\n\r\n      // 生成表格数据\r\n      this.tableData = [\r\n        { time: '2024-01-20 10:00', device: '反应釜A', value: 65.2 },\r\n        { time: '2024-01-20 10:30', device: '反应釜A', value: 66.5 }\r\n      ]\r\n      this.total = this.tableData.length\r\n    },\r\n\r\n    // 导出数据\r\n    exportData() {\r\n      const wb = XLSX.utils.book_new()\r\n      const ws = XLSX.utils.json_to_sheet(this.tableData)\r\n      XLSX.utils.book_append_sheet(wb, ws, '分析数据')\r\n      const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' })\r\n      saveAs(new Blob([wbout], { type: 'application/octet-stream' }), '分析数据.xlsx')\r\n    },\r\n\r\n    // 导出图表\r\n    exportImage() {\r\n      const chart = echarts.getInstanceByDom(document.getElementById('mainChart'))\r\n      const url = chart.getDataURL()\r\n      saveAs(this.dataURLtoBlob(url), '分析图表.png')\r\n    },\r\n\r\n    // DataURL转Blob\r\n    dataURLtoBlob(dataurl) {\r\n      const arr = dataurl.split(',')\r\n      const mime = arr[0].match(/:(.*?);/)[1]\r\n      const bstr = atob(arr[1])\r\n      let n = bstr.length\r\n      const u8arr = new Uint8Array(n)\r\n      while (n--) {\r\n        u8arr[n] = bstr.charCodeAt(n)\r\n      }\r\n      return new Blob([u8arr], { type: mime })\r\n    },\r\n\r\n    // 保存为模板\r\n    saveAsTemplate() {\r\n      this.templateDialogVisible = true\r\n    },\r\n\r\n    // 保存模板\r\n    saveTemplate() {\r\n      this.$refs.templateForm.validate(valid => {\r\n        if (valid) {\r\n          // 保存模板逻辑\r\n          this.$message.success('模板保存成功')\r\n          this.templateDialogVisible = false\r\n        }\r\n      })\r\n    },\r\n\r\n    // 重置表单\r\n    resetForm() {\r\n      this.$refs.analysisForm.resetFields()\r\n    },\r\n\r\n    // 分页处理\r\n    handleSizeChange(val) {\r\n      this.pageSize = val\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.currentPage = val\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.analysis {\r\n  padding: 20px;\r\n}\r\n\r\n.chart-container {\r\n  margin: 20px 0;\r\n}\r\n\r\n.analysis-conclusion {\r\n  margin: 20px 0;\r\n}\r\n\r\n.data-table {\r\n  margin-top: 20px;\r\n}\r\n\r\n.pagination-container {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n}\r\n\r\n.el-form-item {\r\n  margin-bottom: 18px;\r\n}\r\n</style>"]}]}